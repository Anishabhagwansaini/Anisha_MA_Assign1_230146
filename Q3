// Helper function to calculate base^exp with early stopping if result > m
long long power(long long base, int exp, int m) {
    long long result = 1;
    for (int i = 0; i < exp; i++) {
        result *= base;
        if (result > m) return result; // early exit to avoid overflow
    }
    return result;
}

int NthRoot(int n, int m) {
    int low = 1, high = m;
    
    while (low <= high) {
        int mid = (low + high) / 2;
        long long midPow = power(mid, n, m);

        if (midPow == m) return mid;
        else if (midPow < m) low = mid + 1;
        else high = mid - 1;
    }

    return -1; // no integer root found
}
